if (self.CavalryLogger) { CavalryLogger.start_js(["NYuDb"]); }

__d("XEventsMercuryRSVPController",["XController"],(function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/events\/mercury\/rsvp\/",{event_id:{type:"Int",required:true},acontext:{type:"StringToStringMap",required:true},guest_status:{type:"Enum",required:true,enumType:1}});}),null);
__d("XEventsMercurySetWatchStatusController",["XController"],(function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/events\/mercury\/watch_status\/",{event_id:{type:"Int",required:true},acontext:{type:"StringToStringMap",required:true},watch_status:{type:"Enum",required:true,enumType:1}});}),null);
__d('MercuryEventShareAttachment.react',['cx','ix','xuiglyph','AsyncRequest','CenteredContainer.react','EventRSVPActionStrings','Grid.react','Image.react','Link.react','MercuryAttachment','MercuryFallbackShareAttachment.react','MercuryShareAttachmentReactShape','MercuryShareAttachmentRenderLocations','React','XEventsMercuryRSVPController','XEventsMercurySetWatchStatusController','XUIButton.react'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k,l,m,n;if(c.__markCompiled)c.__markCompiled();var o=c('Grid.react').GridItem,p=c('React').PropTypes,q=c('MercuryShareAttachmentRenderLocations').CHAT,r=c('MercuryShareAttachmentRenderLocations').CHAT_PREVIEW,s=c('MercuryShareAttachmentRenderLocations').MESSENGER,t=c('MercuryShareAttachmentRenderLocations').WEB_INBOX;k=babelHelpers.inherits(u,c('React').Component);l=k&&k.prototype;function u(){var w,x;for(var y=arguments.length,z=Array(y),aa=0;aa<y;aa++)z[aa]=arguments[aa];return x=(w=l.constructor).call.apply(w,[this].concat(z)),this.state={guestStatus:this.props.guestStatus,watchStatus:this.props.watchStatus},this.$EventActionButton1=function(){var ba=this.state.guestStatus==='going'?'not_going':'going';this.setState({guestStatus:ba});this.props.onClick(ba);}.bind(this),this.$EventActionButton2=function(){var ba=null;if(this.state.watchStatus==='watched'||this.state.watchStatus==='going'){ba='unwatched';}else ba='watched';this.setState({watchStatus:ba});this.props.onInterestedClick(ba);}.bind(this),this.renderRSVPButton=function(){var ba=this.state.guestStatus==='going';if(this.props.enableRSVP){if(ba)return (c('React').createElement(c('XUIButton.react'),{label:this.props.connectedText,onClick:this.$EventActionButton2}));return (c('React').createElement(c('XUIButton.react'),{image:c('React').createElement(c('Image.react'),{src:i('/images/icons/ads/inline_event.png')}),label:this.props.unconnectedText,onClick:this.$EventActionButton1}));}else if(ba)return (c('React').createElement(c('XUIButton.react'),{className:"_54ap",label:this.props.connectedText,disabled:true}));return null;}.bind(this),this.renderInterestedButton=function(){if(!this.props.enableWatch)return null;if(this.state.watchStatus==='unwatched'){return (c('React').createElement(c('XUIButton.react'),{label:c('EventRSVPActionStrings').getInterestedActionText(),onClick:this.$EventActionButton2,image:c('React').createElement(c('Image.react'),{src:i('/images/events/interested-button.png')})}));}else if(this.state.watchStatus==='watched'){return (c('React').createElement(c('XUIButton.react'),{label:c('EventRSVPActionStrings').getInterestedDecidedText(),onClick:this.$EventActionButton2,image:c('React').createElement(c('Image.react'),{src:j({name:'checkmark',shade:'dark',size:'small'})})}));}else if(this.state.watchStatus==='going')return (c('React').createElement(c('XUIButton.react'),{label:c('EventRSVPActionStrings').getGoingDecidedText(),onClick:this.$EventActionButton2,image:c('React').createElement(c('Image.react'),{src:j({name:'checkmark',shade:'dark',size:'small'})})}));}.bind(this),x;}u.prototype.componentWillReceiveProps=function(w){this.setState({guestStatus:w.guestStatus,watchStatus:w.watchStatus});};u.prototype.render=function(){if(this.props.showInterestedAction){return this.renderInterestedButton();}else return this.renderRSVPButton();};u.propTypes={eventID:p.string.isRequired,guestStatus:p.string.isRequired,watchStatus:p.string,connectedText:p.string.isRequired,unconnectedText:p.string.isRequired,enableRSVP:p.bool,showInterestedAction:p.bool,enableWatch:p.bool,onClick:p.func.isRequired,onInterestedClick:p.func.isRequired};m=babelHelpers.inherits(v,c('React').Component);n=m&&m.prototype;function v(){var w,x;for(var y=arguments.length,z=Array(y),aa=0;aa<y;aa++)z[aa]=arguments[aa];return x=(w=n.constructor).call.apply(w,[this].concat(z)),this.state={eventData:this.props.attachment.target},this.$MercuryEventShareAttachment1=function(ba){if(c('MercuryShareAttachmentRenderLocations').isPreview(this.props.location))return ba;return (c('React').createElement(c('Link.react'),{className:"_5rw4",href:this.props.attachment.uri,target:'_blank'},ba));}.bind(this),this.$MercuryEventShareAttachment2=function(ba,ca){if(ba.image){var da=c('MercuryAttachment').resizeContain({width:ca,height:ca},ba.image_size),ea=da.width,fa=da.height;return this.$MercuryEventShareAttachment1(c('React').createElement(c('Image.react'),{src:ba.image,height:fa,width:ea,className:"_1shx"}));}return null;}.bind(this),this.$MercuryEventShareAttachment3=function(ba){new (c('AsyncRequest'))(c('XEventsMercuryRSVPController').getURIBuilder().setInt('event_id',this.state.eventData.eventID).setEnum('guest_status',ba).setStringToStringMap('acontext',{source:48}).getURI()).setHandler(function(ca){this.setState({eventData:ca.payload});}.bind(this)).send();}.bind(this),this.$MercuryEventShareAttachment4=function(ba){new (c('AsyncRequest'))(c('XEventsMercurySetWatchStatusController').getURIBuilder().setInt('event_id',this.state.eventData.eventID).setEnum('watch_status',ba).setStringToStringMap('acontext',{source:48}).getURI()).setHandler(function(ca){this.setState({eventData:ca.payload});}.bind(this)).send();}.bind(this),x;}v.prototype.render=function(){if(!this.state.eventData)return c('React').createElement(c('MercuryFallbackShareAttachment.react'),this.props);var w=this.props,x=w.attachment,y=w.maxWidth,z=this.state.eventData,aa=z.eventID,ba=z.guestStatus,ca=z.canViewerJoin,da=z.timeString,ea=z.locationString,fa=z.socialContextString,ga=z.connectedButtonText,ha=z.unconnectedButtonText,ia=z.watchStatus,ja=z.showInterestedAction,ka=z.canViewerWatch;if(this.props.location===s)ca=false;var la=c('React').createElement('div',null,this.$MercuryEventShareAttachment1(x.title)),ma=da?c('React').createElement('div',null,da):null,na=ea?c('React').createElement('div',null,ea):null,oa=fa?c('React').createElement('div',null,fa):null,pa=c('React').createElement(u,{className:"_3-9b",connectedText:ga,unconnectedText:ha,eventID:aa,guestStatus:ba,enableRSVP:ca,watchStatus:ia,enableWatch:ka,showInterestedAction:ja,onClick:this.$MercuryEventShareAttachment3,onInterestedClick:this.$MercuryEventShareAttachment4});if(this.props.location===r||this.props.location===q)return (c('React').createElement('div',{style:{maxWidth:y}},this.$MercuryEventShareAttachment2(x.media,y),c('React').createElement('div',{className:"_2ph_"},la,c('React').createElement('div',{className:"_54aq"},ma,na,oa),c('React').createElement(c('CenteredContainer.react'),{vertical:true,className:"_2pie"},pa))));return (c('React').createElement('div',{className:(this.props.location===t?"_3-8y":'')+(this.props.location===s?' '+"_52mr":'')+(this.props.location===s?' '+"_5i_d":''),style:{maxWidth:y}},this.$MercuryEventShareAttachment2(x.media,y),c('React').createElement('div',{className:(this.props.location===t?"_54as":'')+(' '+"_2ph_")},c('React').createElement(c('Grid.react'),{cols:2,alignv:'middle',style:{width:'100%'}},c('React').createElement(o,{className:"_2pij"},la,c('React').createElement('div',{className:"_54aq"},ma,na,oa)),c('React').createElement(o,{alignh:'right'},pa)))));};v.propTypes={attachment:c('MercuryShareAttachmentReactShape'),location:p.oneOf(c('MercuryShareAttachmentRenderLocations').getValues()),rootClassName:p.string};f.exports=v;}),null);